CREATE SCHEMA core;

CREATE TABLE core.user (
                           id_user SERIAL PRIMARY KEY,
                           username VARCHAR(50) NOT NULL,
                           password VARCHAR(100) NOT NULL,
                           admin BOOLEAN NOT NULL DEFAULT FALSE,
                           creation_date DATE NOT NULL DEFAULT CURRENT_DATE
);

CREATE TABLE core.city (
                           id_city SERIAL PRIMARY KEY,
                           name VARCHAR(100) NOT NULL
);

CREATE TABLE core.ad (
                         id_ad SERIAL PRIMARY KEY,
                         title VARCHAR(200) NOT NULL,
                         short_desc VARCHAR(1000) NULL,
                         long_desc VARCHAR(5000) NULL,
                         price REAL NULL, -- NULL - po dogovoru
                         ad_type INTEGER NOT NULL, -- 1 = prodaja, 2 = potražnja
                         upload_time TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
                         state INTEGER NOT NULL, -- 1 = novo, 2 = korišteno, 3 = oboje
                         id_user INTEGER NOT NULL REFERENCES core.user(id_user) ON DELETE CASCADE,
                         id_city INTEGER NOT NULL REFERENCES core.city(id_city)
);

CREATE TABLE core.contact_information (
                                          id_contact SERIAL PRIMARY KEY,
                                          contact_type VARCHAR(50) NOT NULL,
                                          information VARCHAR(255) NOT NULL,
                                          id_user INTEGER NOT NULL REFERENCES core.user(id_user) ON DELETE CASCADE
);

CREATE TABLE core.ad_report (
                                id_report SERIAL PRIMARY KEY,
                                time TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
                                id_ad INTEGER NOT NULL REFERENCES core.ad(id_ad) ON DELETE CASCADE
);

CREATE TABLE core.image (
                            ordinal_number SERIAL PRIMARY KEY,
                            id_ad INTEGER NOT NULL REFERENCES core.ad(id_ad) ON DELETE CASCADE,
                            image_data TEXT NOT NULL
);

CREATE TABLE core.property (
                               id_property SERIAL PRIMARY KEY,
                               id_ad INTEGER NOT NULL REFERENCES core.ad(id_ad) ON DELETE CASCADE,
                               property_name VARCHAR(255) NOT NULL,
                               property_value VARCHAR(255) NOT NULL
);

CREATE SEQUENCE core.user_id_seq START 100000 INCREMENT 1;
CREATE SEQUENCE core.city_id_seq START 1 INCREMENT 1;
CREATE SEQUENCE core.ad_id_seq START 100000 INCREMENT 1;
CREATE SEQUENCE core.contact_information_id_seq START 100000 INCREMENT 1;
CREATE SEQUENCE core.ad_report_id_seq START 100000 INCREMENT 1;
CREATE SEQUENCE core.image_ordinal_seq START 100000 INCREMENT 1;
CREATE SEQUENCE core.property_id_seq START 100000 INCREMENT 1;

ALTER TABLE core.user ALTER COLUMN id_user SET DEFAULT nextval('core.user_id_seq');
ALTER TABLE core.city ALTER COLUMN id_city SET DEFAULT nextval('core.city_id_seq');
ALTER TABLE core.ad ALTER COLUMN id_ad SET DEFAULT nextval('core.ad_id_seq');
ALTER TABLE core.contact_information ALTER COLUMN id_contact SET DEFAULT nextval('core.contact_information_id_seq');
ALTER TABLE core.ad_report ALTER COLUMN id_report SET DEFAULT nextval('core.ad_report_id_seq');
ALTER TABLE core.image ALTER COLUMN ordinal_number SET DEFAULT nextval('core.image_ordinal_number_seq');
ALTER TABLE core.property ALTER COLUMN id_property SET DEFAULT nextval('core.property_id_seq');

INSERT INTO core.city (name) VALUES
('Zagreb'),
('Split'),
('Rijeka'),
('Osijek'),
('Sesvete'),
('Zadar'),
('Velika Gorica'),
('Pula'),
('Karlovac'),
('Slavonski Brod'),
('Varaždin'),
('Šibenik'),
('Dubrovnik'),
('Sisak'),
('Kaštel Stari'),
('Samobor'),
('Bjelovar'),
('Vinkovci'),
('Koprivnica'),
('Čakovec'),
('Zaprešić'),
('Solin'),
('Ðakovo'),
('Sinj'),
('Vukovar'),
('Požega'),
('Petrinja'),
('Kutina'),
('Virovitica'),
('Križevci'),
('Dugo Selo'),
('Poreč'),
('Viškovo'),
('Metković'),
('Sveti Ivan Zelina'),
('Jastrebarsko'),
('Našice'),
('Omiš'),
('Makarska'),
('Ivanić-Grad'),
('Vrbovec'),
('Rovinj'),
('Ivanec'),
('Umag'),
('Trogir'),
('Ogulin'),
('Novi Marof'),
('Nova Gradiška'),
('Knin'),
('Krapina'),
('Slatina'),
('Gospić'),
('Novska'),
('Nedelišće'),
('Matulji'),
('Brdovec'),
('Opatija'),
('Labin'),
('Podstrana'),
('Popovača'),
('Duga Resa'),
('Kastav'),
('Daruvar'),
('Crikvenica'),
('Valpovo'),
('Benkovac'),
('Čepin'),
('Županja'),
('Imotski'),
('Pleternica'),
('Belišće'),
('Zabok'),
('Vodice'),
('Garešnica'),
('Ludbreg'),
('Pitomača'),
('Otočac'),
('Pazin'),
('Ploče'),
('Trilj'),
('Donji Miholjac'),
('Beli Manastir'),
('Drenova'),
('Bakar'),
('Mali Lošinj'),
('Ðurđevac'),
('Bedekovčina'),
('Rab'),
('Rugvica'),
('Glina'),
('Pakrac'),
('Čavle'),
('Prelog'),
('Lepoglava'),
('Čazma'),
('Dugi Rat'),
('Krk'),
('Medulin'),
('Kaštel Sućurac'),
('Ivankovo'),
('Kaštel Novi'),
('Donja Bistra'),
('Drniš'),
('Trnovec Bartolovečki'),
('Križ'),
('Buzet'),
('Pregrada'),
('Brckovljani'),
('Mursko Središće'),
('Vodnjan'),
('Ozalj'),
('Oroslavje'),
('Sibinj'),
('Vrgorac'),
('Maruševec'),
('Sveti Križ Začretje'),
('Biograd na Moru'),
('Zlatar'),
('Marija Bistrica'),
('Varaždinske Toplice'),
('Kloštar Ivanić'),
('Erdut'),
('Darda'),
('Cestica'),
('Korčula'),
('Grubišno Polje'),
('Lekenik'),
('Ðurđenovac'),
('Donja Stubica'),
('Suhopolje'),
('Klis'),
('Kaštel Lukšić'),
('Delnice'),
('Lipik'),
('Jelenje'),
('Kaštel Kambelovac'),
('Ilok'),
('Klinča Sela'),
('Vidovec'),
('Gornji Kneginec'),
('Kutjevo'),
('Nuštar'),
('Krapinske Toplice'),
('Bilje'),
('Oriovac'),
('Kaštel Gomilica'),
('Sračinec'),
('Poličnik'),
('Sukošan'),
('Gornja Stubica'),
('Hum na Sutli'),
('Petrijanec'),
('Orahovica'),
('Velika'),
('Sveti Filip i Jakov'),
('Veliko Trgovišće'),
('Buje'),
('Kostrena'),
('Mala Subotica'),
('Sveti Ivan Žabno'),
('Novi Vinodolski'),
('Supetar'),
('Marina'),
('Marčana'),
('Trpinja'),
('Rovišće'),
('Staro Petrovo Selo'),
('Pakoštane'),
('Ližnjan'),
('Kraljevica'),
('Donji Kraljevec'),
('Podbablje'),
('Hvar'),
('Bibinje'),
('Garčin'),
('Sveti Petar Orehovec'),
('Novigrad'),
('Rešetari'),
('Virje'),
('Jakovlje'),
('Ðurmanec'),
('Vela Luka'),
('Dugopolje'),
('Bizovac'),
('Cerna'),
('Orebić'),
('Novalja'),
('Drenovci'),
('Josipovac'),
('Glavice'),
('Semeljci'),
('Preko'),
('Borovo'),
('Lovran'),
('Nijemci'),
('Podturen'),
('Jelsa'),
('Pisarovina'),
('Fažana'),
('Andrijaševci'),
('Posedarje'),
('Josipdol'),
('Antunovac'),
('Bednja'),
('Jakšić'),
('Žminj'),
('Skradin'),
('Sveti Ðurđ'),
('Konjšćina'),
('Špišić-Bukovica'),
('Žrnovnica'),
('Stari Jankovci'),
('Sveti Ilija'),
('Jalžabet'),
('Pag'),
('Koška'),
('Donji Proložac'),
('Donji Andrijevci'),
('Podvinje'),
('Vir'),
('Okrug Gornji'),
('Omišalj'),
('Lučko'),
('Radoboj'),
('Cernik'),
('Pribislavec'),
('Kotoriba'),
('Tisno'),
('Nedeščina'),
('Stobreč'),
('Bošnjaci'),
('Martinska Ves'),
('Opuzen'),
('Kršan'),
('Kaštel Štafilić'),
('Vrpolje'),
('Bebrina'),
('Raša'),
('Lipovljani'),
('Sokolovac'),
('Starigrad'),
('Babina Greda'),
('Lukač'),
('Nova Rača'),
('Kloštar Podravski'),
('Ražanac'),
('Stubičke Toplice'),
('Bukovlje'),
('Orehovica'),
('Šenkovec'),
('Nin'),
('Lobor'),
('Barilović'),
('Hrvatski Leskovac'),
('Martijanec'),
('Rasinja'),
('Primošten'),
('Velika Kopanica'),
('Gunja'),
('Strahoninec'),
('Baška Voda'),
('Donja Pušća'),
('Klanjec'),
('Draganići'),
('Marčelji'),
('Desinić'),
('Davor'),
('Barban'),
('Petrijevci'),
('Čeminac'),
('Podgorač'),
('Netretić'),
('Stari Mikanovci'),
('Gradac'),
('Sveti Martin na Muri'),
('Veliko Trojstvo'),
('Kapela'),
('Brodski Stupnik'),
('Štrigova'),
('Goričan'),
('Zlatar Bistrica'),
('Novigrad Podravski'),
('Peteranec'),
('Velika Ludina'),
('Petrovsko'),
('Mače'),
('Ivanska'),
('Krašić'),
('Gradište'),
('Podcrkavlje'),
('Privlaka'),
('Cavtat'),
('Budinšćina'),
('Svetvinčenat'),
('Generalski Stol'),
('Gornja Vrba'),
('Novigrad'),
('Zemunik Donji'),
('Dobrinj'),
('Pašman'),
('Privlaka'),
('Drenje'),
('Rogoznica'),
('Višnjan'),
('Marija Gorica'),
('Gornji Stupnik'),
('Tovarnik'),
('Beretinec'),
('Vrsi'),
('Tuhelj'),
('Donja Voća'),
('Sikirevci'),
('Ravna Gora'),
('Strizivojna'),
('Klakar'),
('Jarmina'),
('Sveta Marija'),
('Dežanovac'),
('Breznica'),
('Koprivnički Bregi'),
('Runović'),
('Oprisavci'),
('Marjanci'),
('Draž'),
('Ernestinovo'),
('Pokupsko'),
('Domašinec'),
('Vrsar'),
('Vis'),
('Legrad'),
('Hercegovac'),
('Punat'),
('Sopje'),
('Hrvatska Kostajnica'),
('Petlovac'),
('Klana'),
('Stankovci'),
('Kravarsko'),
('Tučepi'),
('Mali Bukovec'),
('Končanica'),
('Cista Provo'),
('Koprivnički Ivanec'),
('Klenovnik'),
('Satnica Ðakovačka'),
('Markušica'),
('Molve'),
('Orle'),
('Gornji Mihaljevec'),
('Žakanje'),
('Tinjan'),
('Feričanci'),
('Pićan'),
('Starigrad'),
('Vrbje'),
('Ljubešćica'),
('Štefanje'),
('Bol'),
('Vratišinec'),
('Šestanovac'),
('Škabrnje'),
('Tordinci'),
('Baška'),
('Zmijavci'),
('Vođinci'),
('Brela'),
('Viljevo'),
('Selca'),
('Gundinci'),
('Pirovac'),
('Tribunj'),
('Kraljevec na Sutli'),
('Kali'),
('Slavonski Šamac'),
('Punitovci'),
('Farkaševac'),
('Gornja Rijeka'),
('Čađavica'),
('Vladislavci'),
('Štitar'),
('Bogdanovci'),
('Postire'),
('Drnje'),
('Brtonigla'),
('Kanfanar'),
('Viškovci'),
('Zdenci'),
('Popovac'),
('Podravske Sesvete'),
('Gornji Bogičevci'),
('Ferdinandovac'),
('Kula Norinska'),
('Kumrovec'),
('Šandrovac'),
('Karojba'),
('Komiža'),
('Fužine'),
('Polača'),
('Hrašćina'),
('Pučišće'),
('Jesenice'),
('Visoko'),
('Donja Motičina'),
('Veliki Bukovec'),
('Lasinja'),
('Velika Pisanica'),
('Gračišće'),
('Kalinovac'),
('Mošćenička Draga'),
('Ðelekovec'),
('Nova Bukovica'),
('Bedenica'),
('Luka'),
('Gorjani'),
('Šodolovci'),
('Lumbarda'),
('Donji Vidovec'),
('Vrbnik'),
('Hlebine'),
('Kalnik'),
('Tar'),
('Vižinada'),
('Rakovec'),
('Breznički Hum'),
('Preseka'),
('Tompojevci'),
('Lopar'),
('Velika Trnovitica'),
('Mikleuš'),
('Dragalić'),
('Sveti Petar u Šumi'),
('Novo Virje'),
('Negoslavci'),
('Lovas'),
('Sveti Lovreč Pazenatički'),
('Podravska Moslavina'),
('Sutivan'),
('Milna'),
('Motovun'),
('Funtana'),
('Lopatinec'),
('Zagorska Sela'),
('Smokvica'),
('Skrad'),
('Lokve'),
('Kamanje'),
('Novi Golubovec'),
('Malinska'),
('Kolan'),
('Zrinski Topolovac'),
('Dekanovec'),
('Severin'),
('Primorski Dolac'),
('Trpanj'),
('Povljana'),
('Lokvičič'),
('Vrhovine'),
('Kukljica'),
('Donji Muć'),
('Janjina'),
('Lećevica'),
('Vlaka'),
('Grohote'),
('Kaštelir'),
('Zadvarje'),
('Mlinište'),
('Sveta Nedjelja'),
('Donji Seget'),
('Srebreno'),
('Galovac'),
('Poljanica Bistranska'),
('Selnica'),
('Bilice'),
('Belica'),
('Vinica'),
('Donja Dubrava'),
('Dubravica'),
('Murter'),
('Gornje Jesenje'),
('Otok'),
('Mihovljan'),
('Vuka'),
('Dubrava'),
('Gradec'),
('Kraj'),
('Otok'),
('Blato'),
('Kaptol'),
('Gola'),
('Nova Kapela'),
('Gradina'),
('Podgora'),
('Bribir'),
('Otrić-Seoci'),
('Trnava'),
('Sunja');

INSERT INTO core.user (id_user, username, password, creation_date) VALUES
(1, 'marko123', 'E3C4A8E68C23890091F9B9531EF3E0F805CE0A9378D6FB4BBCB6EED403C91342', '2025-01-01'),
(2, 'petar456', '0A33A99F0D29627D8B811B4D3EFC53F720C0CC21098D5AF549D93DED5668323A', '2024-08-28'),
(3, 'hrvoje789', '4F92111CFD0E48888742C44604F5F5A2C7674554F7B187A82299F51B46A30748', '2023-01-06');

INSERT INTO core.user (id_user, username, password, admin, creation_date) VALUES
(4, 'admin', '8C6976E5B5410415BDE908BD4DEE15DFB167A9C873FC4BB8A81F6F2AB448A918', TRUE, '2022-01-01');

INSERT INTO core.contact_information (contact_type, information, id_user) VALUES
('mob. telefon', '099-1234-567', 1),
('mail', 'marko@email.com', 1),
('telefon', '095-333-4444', 2),
('telefon', '099-9876-543', 3),
('e-pošta', 'admin@oglasi.hr', 4);

INSERT INTO core.ad (
    id_ad, title, short_desc, long_desc, price,
    ad_type, upload_time, state, id_user, id_city
)
VALUES (
    1,
    'Prodajem bicikl',
    'Crni MTB bicikl, odličan za grad',
    'Bicikl je star godinu dana, malo korišten, u odličnom stanju.',
    120.00,
    1, -- prodaja
    NOW(),
    1, -- novo
    1,
    1 -- Zagreb
),
(
    2,
    'Prodajem stan',
    'Stan 50 m² u centru',
    'Stan se nalazi u centru Zagreba, renoviran, dostupan odmah.',
    150000.00,
    1,
    NOW() - INTERVAL '2 days',
    2,
    2,
    1
),
(
    3,
    'Poklanjam knjige',
    'Besplatne knjige za studente',
    'Književnost, ekonomija, informatika - poklanjam kolekciju od 30 knjiga.',
    0.00,
    1,
    NOW() - INTERVAL '5 days',
    2,
    3,
    3
),
(
    4,
    'Prodajem iPhone 15',
    'Odličan mobitel, kao nov',
    'iPhone 13, 128GB, star 6 mjeseci, bez ogrebotina, full oprema.',
    600.00,
    1,
    NOW() - INTERVAL '1 week',
    1,
    3,
    3
),
(
    5,
    'Prodajem gaming računalo',
    'i7, RTX 3070, 32GB RAM',
    'Savršeno za igre i rad. Kupljeno prošle godine, sve radi bez greške.',
    950.00,
    1,
    NOW() - INTERVAL '3 days',
    2,
    2,
    1
);

INSERT INTO core.property (id_ad, property_name, property_value) VALUES
(1, 'Broj brzina', '7'),
(2, 'Površina', '50m2'),
(2, 'Broj soba', '2'),
(2, 'Broj kupaonica', '1'),
(3, 'Žanr', 'Razno'),
(4, 'Kapacitet', '128GB'),
(4, 'Boja', 'Crna'),
(5, 'Procesor', 'i7'),
(5, 'Grafička kartica', 'RTX 3070'),
(5, 'RAM', '32GB');

INSERT INTO core.ad_report (time, id_ad) VALUES
(NOW(), 1),
(NOW() - INTERVAL '1 day', 2),
(NOW() - INTERVAL '2 days', 2),
(NOW() - INTERVAL '3 days', 3),
(NOW() - INTERVAL '4 days', 4);